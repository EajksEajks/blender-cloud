<VirtualHost *:80>
	XSendFile on
	XSendFilePath /data/storage/pillar
	XSendFilePath /data/git/pillar
	XSendFilePath /data/git/attract/attract/static/
	XSendFilePath /data/git/flamenco/flamenco/static/
	XsendFilePath /data/git/blender-cloud

	ServerAdmin webmaster@localhost
	DocumentRoot /var/www/html

	# Available loglevels: trace8, ..., trace1, debug, info, notice, warn,
	# error, crit, alert, emerg.
	# It is also possible to configure the loglevel for particular
	# modules, e.g.
	# LogLevel info ssl:warn

	ErrorLog ${APACHE_LOG_DIR}/error.log
	CustomLog ${APACHE_LOG_DIR}/access.log combined

	WSGIDaemonProcess cloud processes=4 threads=1 maximum-requests=10000
	WSGIPassAuthorization On

	WSGIScriptAlias / /data/git/blender-cloud/runserver.wsgi \
		process-group=cloud application-group=%{GLOBAL}

	<Directory /data/git/blender-cloud>
		<Files runserver.wsgi>
			Require all granted
		</Files>
	</Directory>

	# Temporary edit to remap the old cloudapi.blender.org to cloud.blender.org/api
	RewriteEngine On
	RewriteCond "%{HTTP_HOST}"   "^cloudapi\.blender\.org" [NC]
	RewriteRule (.*) /api$1 [PT]

	# Redirect for blender-cloud main project
	RewriteRule "^/p/blender-cloud/?$"  "/blog" [R=302]

	# Redirects for short links
	Redirect /agent327 /p/agent-327
	Redirect /caminandes /p/caminandes-3
	Redirect /cf2 /p/creature-factory-2
	Redirect /characters /p/characters
	Redirect /gallery /p/gallery
	Redirect /hdri /p/hdri
	Redirect /textures /p/textures
</VirtualHost>
