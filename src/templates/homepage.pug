| {% extends 'layout.html' %}
| {% from '_macros/_navigation.html' import navigation_homepage %}
| {% from '_macros/_asset_list_item.html' import asset_list_item %}
| {% from 'nodes/custom/blog/_macros.html' import render_blog_post %}

include ../../../pillar/src/templates/mixins/components

| {% set title = 'homepage' %}

| {% block og %}
meta(property="og:type", content="website")
meta(property="og:url", content="{{ request.url }}")

meta(property="og:title", content="Blender Cloud")
meta(name="twitter:title", content="Blender Cloud")

meta(property="og:description", content="Blender Cloud is a web based service developed by Blender Institute that allows people to access the training videos and all the data from the open projects.")
meta(name="twitter:description", content="Blender Cloud is a web based service developed by Blender Institute that allows people to access the training videos and all the data from the open projects.")

meta(property="og:image", content="{% if main_project.picture_header %}{{ main_project.picture_header.thumbnail('l', api=api) }}{% else %}{{ url_for('static', filename='assets/img/backgrounds/background_agent327_04.jpg')}}{% endif %}")
meta(name="twitter:image", content="{% if main_project.picture_header %}{{ main_project.picture_header.thumbnail('l', api=api) }}{% else %}{{ url_for('static', filename='assets/img/backgrounds/background_agent327_04.jpg')}}{% endif %}")
| {% endblock %}

| {% block navigation_tabs %}
| {{ navigation_homepage(title) }}
| {% endblock navigation_tabs %}

| {% block body %}
.container-fluid.dashboard-container.imgs-fluid
	.row.mt-3
		.col-md-9.col-xl-6.mx-auto
			+timeline()

			.d-block.text-center
				a.d-inline-block.p-3.text-muted(href="{{ url_for('main.main_blog') }}")
					| See All Blog Posts

				a.d-inline-block.p-3.text-muted(
					href="{{ url_for('main.feeds_blogs') }}",
					title="Blogs Feed",
					data-toggle="tooltip",
					data-placement="left")
					i.pi-rss
					| RSS Feed

		.col-md-9.col-xl-4.mx-auto
			section.py-3.border-bottom.mb-3
				h6.title-underline
					| Featured Projects
				.row.pt-3
					.col-md-6
						a.text-muted(href="/p/spring", style="text-decoration: none")
							h6.font-weight-bold.mt-2 SPRING
							p.text-muted.pt-2
								| A poetic short film about a mountain spirit and her little dog.

							a.btn.btn-link.btn-sm.pl-0(href="/p/spring")
								| See more
								i.pi-angle-right

					.col-md-6
						a(href="/p/spring/")
							img.rounded(
								alt="Spring Open Movie Project",
								src="{{ url_for('static', filename='assets/img/projects/spring_sidebar_02.jpg')}}")

				.row.pt-3.mt-3.border-top
					.col-md-6
						a.text-muted(href="/p/speed-sculpting/", style="text-decoration: none")
							h6.font-weight-bold.mt-2 SPEED SCULPTING
							p.text-muted.pt-2
								| Learn how to speed up your workflow sculpting in Blender 2.8 with Julien Kaspar.

							a.btn.btn-link.btn-sm.pl-0(href="/p/speed-sculpting/")
								| Watch Training
								i.pi-angle-right

					.col-md-6
						a(href="/p/speed-sculpting/")
							img.rounded(
								alt="Speed Sculpting Workshop",
								src="{{ url_for('static', filename='assets/img/features/training_speed_sculpting.jpg')}}")

			section.py-3.border-bottom.mb-3
				h6.title-underline
					a.text-muted(href="{{ url_for('main.nodes_search_index') }}")
						| Random Awesome

				| {% if random_featured %}
				+card-deck()(class='pl-3 random-featured')
					| {% for child in random_featured %}
					| {% if child.node_type not in ['comment'] %}
					| {{ asset_list_item(child, current_user) }}
					| {% endif %}
					| {% endfor %}
				| {% else %}
				.card
					.card-body
						h6.card-title
							| No random featured.
				| {% endif %}

			section.py-3
				h6.title-underline Latest Comments

				ul.list-unstyled.pt-2
					| {% if latest_comments %}
					| {% for n in latest_comments %}
					li.pb-2.mb-2.border-bottom.text-truncate

						a.js-comment-content.text-muted(href="{{ n.url }}")
							| {{ n.properties.content | striptags | truncate(200) }}

						| {% if n.attached_to %}
						.d-flex.align-items-baseline
							a.text-muted.text-truncate(href="{{ n.attached_to.url }}")
								small.pr-2.font-weight-bold {{ n.project.name }}
								small {{ n.attached_to.name }}
						| {% endif %}

						.d-flex.align-items-baseline
							small.pr-2.font-weight-bold {{ n.user.full_name }}

							a.text-muted(href="{{ n.url }}", title="{{ n._created }}")
								small {{ n._created | pretty_date }}
					| {% endfor %}

					| {% else %}
					span
						| No comments... yet!

					| {% endif %}


| {% endblock %}


| {% block footer_scripts %}
script.
	$(function () {

	/* cleanup mentions in comments  */
	$('.js-comment-content').each(function(){
		$(this).text($(this).text().replace(/\*|\@|\<(.*?)\>/g, ''));
	});

	hopToTop(); // Display jump to top button
	});
| {% endblock %}
